<div class="container d-flex justify-content-center" *ngIf="user_logged">
    <div class="row">
        <div class="col-8">
            <div class="card border-0">
                <div class="card-body p-0">
                    <h5 class="card-title">Información de la cuenta</h5>
                    <p class="card-subtitle text-secondary mb-4">Aquí puedes visualizar y actualizar la información de tu cuenta.</p>                   
                    <form #updateUserPictureForm="ngForm" (ngSubmit)="updateUserPicture(updateUserPictureForm)">
                        <div class="d-flex align-items-end gap-3">
                            <div *ngIf="user_logged.user_picture; then image_uploaded else empty_image"></div>
                            <ng-template #image_uploaded>
                                <div class="user-picture-account-page-class border position-relative" [ngStyle]="{'background-image': 'url(' + user_logged.user_picture + ')'}">
                                    <button type="button" class="btn btn-secondary position-absolute m-1" (click)="deleteUserPicture()" style="right: 0;" title="Eliminar foto de perfil"><i class="bi bi-x-lg"></i></button>
                                </div>
                            </ng-template>
                            <ng-template #empty_image>
                                <div class="user-picture-account-page-class border position-relative" [ngStyle]="{'background-image': 'url(../../../../assets/img/avatar.jpg)'}">
                                    <button type="button" class="btn btn-secondary position-absolute m-1" (click)="deleteUserPicture()" style="right: 0;" title="Eliminar foto de perfil"><i class="bi bi-x-lg"></i></button>
                                </div>                            </ng-template>
                            <div>
                                <label for="user_picture" class="form-label">Foto de perfil</label>
                                <input type="file" name="user_picture" placeholder="Foto de perfil" class="form-control mb-2" (change)="selectedUserPicture($event)" accept=".jpg,.png,.jpeg" required>
                                <button type="submit" class="btn btn-outline-secondary">Guardar foto</button>
                            </div>
                        </div>
                    </form>

                    <hr class="border">
                    
                    <form #updateAccountForm="ngForm" (ngSubmit)="updateAccount(updateAccountForm)">
                        <div class="row">
                            <div class="col-6 mb-3">
                                <label for="name" class="form-label">Nombre(s)</label>
                                <input 
                                type="text" 
                                name="name" 
                                placeholder="Nombre(s)" 
                                class="form-control" 
                                #name="ngModel"
                                [(ngModel)]="user_logged.name"
                                [ngClass]="{'is-invalid': (user_logged.name.touched || user_logged.name.dirty) && user_logged.name.invalid}" 
                                required>
                                <div *ngIf="(user_logged.name.touched || user_logged.name.dirty) && user_logged.name.invalid" class="text-danger">
                                    Formato de nombre inválido. Este campo solo acepta letras.
                                </div>                         
                            </div>

                            <div class="col-6 mb-3">
                                <label for="last_name" class="form-label">Apellido(s)</label>
                                <input type="text"
                                name="last_name"
                                placeholder="Apellido(s)"
                                class="form-control"
                                #last_name="ngModel"
                                [(ngModel)]="user_logged.last_name"
                                [ngClass]="{'is-invalid': (user_logged.last_name.touched || user_logged.last_name.dirty) && user_logged.last_name.invalid}" 
                                required>
                                <div *ngIf="(user_logged.last_name.touched || user_logged.last_name.dirty) && user_logged.last_name.invalid" class="text-danger">
                                    Formato de apellidos inválido. Este campo solo acepta letras.
                                </div>     
                            </div>         

                            <div class="col-6 mb-3">
                                <label for="birth_date" class="form-label">Fecha de nacimiento</label>
                                <input type="date" 
                                name="birth_date" 
                                placeholder="Fecha de nacimiento" 
                                class="form-control" 
                                #birth_date="ngModel"
                                [(ngModel)]="user_logged.birth_date"
                                [ngClass]="{'is-invalid': (user_logged.birth_date.touched || user_logged.birth_date.dirty) && user_logged.birth_date.invalid}" 
                                required>
                            </div>

                            <div class="col-6 mb-3">
                                <label for="gender" class="form-label">Género</label>
                                <select 
                                name="gender"
                                class="form-control"  
                                #gender="ngModel"
                                [(ngModel)]="user_logged.gender"
                                [ngClass]="{'is-invalid': (user_logged.gender.touched || user_logged.gender.dirty) && user_logged.gender.invalid}" 
                                required>
                                    <option value="">--Selecciona un género</option>
                                    <option value="Hombre">Hombre</option>
                                    <option value="Mujer">Mujer</option>
                                </select>
                            </div>

                            <div class="mb-3">
                                <label for="username" class="form-label">Nombre de usuario</label>
                                <input type="text" 
                                name="username" 
                                placeholder="Nombre de usuario" 
                                class="form-control" 
                                #username="ngModel"
                                [(ngModel)]="user_logged.username"
                                [ngClass]="{'is-invalid': (user_logged.username.touched || user_logged.username.dirty) && user_logged.username.invalid}" 
                                required>
                                <div *ngIf="(user_logged.username.touched || user_logged.username.dirty) && user_logged.username.invalid" class="text-danger">
                                    Formato de nombre de usuario inválido. Este campo solo acepta letras y números.
                                </div>     
                            </div>

                            <div class="mb-3">
                                <label for="email" class="form-label">Correo electrónico</label>
                                <input 
                                type="email" 
                                name="email" 
                                placeholder="Correo electrónico" 
                                class="form-control" 
                                #email="ngModel"
                                [(ngModel)]="user_logged.email"
                                [ngClass]="{'is-invalid': (user_logged.email.touched || user_logged.email.dirty) && user_logged.email.invalid}" 
                                required>
                            </div>

                            <div class="col-6 mb-3">
                                <label for="password" class="form-label">Contraseña</label>
                                <input 
                                type="password" 
                                name="password" 
                                placeholder="Contraseña" 
                                class="form-control" 
                                #password="ngModel"
                                [(ngModel)]="user_logged.password"
                                [ngClass]="{'is-invalid': (user_logged.password.touched || user_logged.password.dirty) && user_logged.password.invalid}" 
                                required>
                                <div *ngIf="(user_logged.password.touched || user_logged.password.dirty) && user_logged.password.invalid" class="text-danger">
                                    Formato de contraseña inválido. Asegúrate de que tu contraseña incluya al menos 8 caracteres, un número, y un símbolo.
                                </div>     
                            </div>

                            <div class="col-6 mb-4">
                                <label for="confirmed_password" class="form-label">Confirmar contraseña</label>
                                <input 
                                type="password" 
                                name="confirmed_password" 
                                placeholder="Confirmar contraseña" 
                                class="form-control" 
                                #confirmed_password_input="ngModel"
                                [(ngModel)]="confirmed_password"
                                [ngClass]="{'is-invalid': (confirmed_password_input.touched || confirmed_password_input.dirty) && confirmed_password != user_logged.password}" 
                                required>
                                <div *ngIf="(confirmed_password_input.touched || confirmed_password_input.dirty) && confirmed_password != user_logged.password" class="text-danger">
                                    Las contraseñas no coinciden.
                                </div>     
                            </div>

                            <button 
                            type="submit" 
                            class="btn btn-primary"
                            [disabled]="updateAccountForm.invalid">
                                Guardar datos
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
   